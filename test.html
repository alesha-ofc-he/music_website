<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tolkyn - Hot Tracks of the Month</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inria+Sans:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        :root {
            --primary-color: #1E3A8A;
            --secondary-color: #F8C0EB;
            --tertiary-color: #F9CEB5;
            --quaternary-color: #C6F7DA;
            --body-bg: #afcfe3;
            --header-footer-bg: #0F172A;
            --player-border: #1E3A8A;
        }
        body {
            font-family: 'Inria Sans', sans-serif;
            background-color: var(--body-bg);
            color: #333;
        }
        .header, .footer {
            background-color: var(--header-footer-bg);
            color: white;
        }
        .nav-link {
            color: white !important;
        }
        .search-icon {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
        }
        .recommendation-card {
            height: 180px;
            border-radius: 26px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .recommendation-card:hover {
            transform: scale(1.05);
        }
        .recommendation-card i {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        .player {
            position: fixed;
            right: 20px;
            bottom: 20px;
            width: 300px;
            background-color: #181818;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            color: white;
            border: 2px solid var(--player-border);
            cursor: move;
        }
        .player img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }
        .player-song-info {
            padding: 10px;
            text-align: center;
        }
        .player-song-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .player-song-artist {
            font-size: 0.9em;
            color: #999;
        }
        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px 0;
        }
        .player-controls i {
            font-size: 1.5rem;
            margin: 0 10px;
            cursor: pointer;
        }
        .progress {
            height: 5px;
            background-color: #535353;
            cursor: pointer;
            margin-bottom: 10px;
        }
        .progress-bar {
            background-color: var(--primary-color);
            height: 100%;
        }
        .song-list {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        .song-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .song-item:last-child {
            border-bottom: none;
        }
        .song-number {
            width: 30px;
            text-align: right;
            margin-right: 10px;
        }
        .song-info {
            flex-grow: 1;
        }
        .song-title {
            font-weight: bold;
        }
        .song-artist {
            font-size: 0.9em;
            color: #666;
        }
        .song-duration {
            width: 50px;
            text-align: right;
        }
        .song-like, .song-play {
            width: 30px;
            text-align: center;
            cursor: pointer;
        }
        .liked {
            color: red;
        }
        .podcast-card {
            border-radius: 26px;
            overflow: hidden;
            background-color: #ffffff;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .podcast-card img {
            height: 180px;
            object-fit: cover;
        }
        .made-with-love {
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 0.7rem;
            opacity: 0.7;
        }
        .player-time {
            display: flex;
            justify-content: space-between;
            padding: 0 10px;
            font-size: 0.8em;
            color: #999;
        }
        .player-controls i, #playPauseBtn, #nextBtn, #prevBtn, #shuffleBtn {
            transition: transform 0.2s ease-in-out;
        }
        .volume-control {
            position: absolute;
            bottom: 100%;
            right: 10px;
            background-color: #181818;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        #volumeSlider {
            width: 100px;
            -webkit-appearance: none;
            background: #535353;
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
            border-radius: 5px;
        }
        #volumeSlider:hover {
            opacity: 1;
        }
        #volumeSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            background: var(--primary-color);
            cursor: pointer;
            border-radius: 50%;
        }
        #volumeSlider::-moz-range-thumb {
            width: 15px;
            height: 15px;
            background: var(--primary-color);
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <header class="header py-3">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <a class="navbar-brand text-white me-4" href="index.html">TOLKYN</a>
                    <nav class="d-flex">
                        <a class="nav-link mx-2" href="/path/to/collections">Collections</a>
                        <a class="nav-link mx-2" href="/path/to/podcasts">Podcasts</a>
                        <a class="nav-link mx-2" href="/path/to/audiobooks">Audiobooks</a>
                    </nav>
                </div>
                <div class="d-flex align-items-center">
                    <div class="position-relative mx-2">
                        <i class="bi bi-search search-icon text-white"></i>
                        <input type="text" class="form-control bg-transparent border-2 border-white rounded-pill text-white" placeholder="Search..." style="padding-left: 30px;">
                    </div>
                    <a class="nav-link mx-2" href="settings.html"><i class="bi bi-gear text-white"></i></a>
                    <a class="nav-link mx-2" href="/path/to/account"><i class="bi bi-person-circle text-white"></i></a>
                </div>
            </div>
            <div class="made-with-love">
                Made with Love! <i class="bi bi-heart-fill text-danger"></i>
            </div>
        </div>
    </header>

    <main class="container my-5">
        <h1 class="mb-4">Home</h1>
        <div class="row g-4">
            <div class="col-md-6 col-lg-3">
                <div id="recentlyPlayed" class="recommendation-card bg-white">
                    <i class="bi bi-play-circle"></i>
                    <p class="mb-0">Recently Played</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div id="likedSongs" class="recommendation-card" style="background-color: var(--secondary-color);">
                    <i class="bi bi-heart"></i>
                    <p class="mb-0">Liked Songs</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div id="hotTracks" class="recommendation-card" style="background-color: var(--tertiary-color);">
                    <i class="bi bi-music-note-beamed"></i>
                    <p class="mb-0">Hot tracks of the month</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="recommendation-card" style="background-color: var(--quaternary-color);">
                    <i class="bi bi-headphones"></i>
                    <p class="mb-0">Playlist of the day</p>
                </div>
            </div>
        </div>

        <div id="songListContainer" class="mt-4 d-none">
            <h2 class="mb-3">Hot Tracks of the Month</h2>
            <div id="songList" class="song-list"></div>
        </div>

        <div id="likedSongsContainer" class="mt-4 d-none">
            <h2 class="mb-3">Liked Songs</h2>
            <div id="likedSongsList" class="song-list"></div>
        </div>

        <section class="mb-5 mt-5">
            <h2 class="fs-2 fw-bold mb-3">Video clips time!</h2>
            <p class="mb-3">Watch all new clips in Tolkyn</p>
            <div class="ratio ratio-16x9">
                <iframe src="https://www.youtube.com/embed/sWqDIZxO-nU" 
                        title="In Rainbows | Radiohead | From The Basement" 
                        allowfullscreen></iframe>
            </div>
        </section>

        <section class="mt-5">
            <h2 class="fs-2 fw-bold mb-4">Podcasts and Audiobooks</h2>
            <div class="row g-4">
                <div class="col-md-6 col-lg-3">
                    <div class="podcast-card">
                        <img src="images/podcast1.png" alt="Elon Musk" class="w-100">
                        <div class="p-3">
                            <h3 class="fs-5 fw-bold">Elon Musk</h3>
                            <p class="mb-0">Walter Isaacson</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="podcast-card">
                        <img src="images/podcast2.png" alt="The Hunter" class="w-100">
                        <div class="p-3">
                            <h3 class="fs-5 fw-bold">The Hunter</h3>
                            <p class="mb-0">Tana French</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="podcast-card">
                        <img src="images/podcast3.png" alt="Pride and Prejudice" class="w-100">
                        <div class="p-3">
                            <h3 class="fs-5 fw-bold">Pride and Prejudice</h3>
                            <p class="mb-0">Jane Austen</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="podcast-card">
                        <img src="images/podcast4.png" alt="Metamorphosis" class="w-100">
                        <div class="p-3">
                            <h3 class="fs-5 fw-bold">Metamorphosis</h3>
                            <p class="mb-0">Franz Kafka</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div id="player" class="player" style="display: none;">
        <img src="images/meremad.png" alt="Album cover" id="playerCover">
        <div class="player-song-info">
            <div class="player-song-title" id="playerSongTitle">Currently Playing Song</div>
            <div class="player-song-artist" id="playerSongArtist">Artist Name</div>
        </div>
        <div class="progress" id="seekBar">
            <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
        <div class="player-time">
            <span id="currentTime">0:00</span>
            <span id="duration">0:00</span>
        </div>
        <div class="player-controls">
            <i class="bi bi-shuffle" id="shuffleBtn"></i>
            <i class="bi bi-skip-start-fill" id="prevBtn"></i>
            <i class="bi bi-play-circle-fill fs-1" id="playPauseBtn"></i>
            <i class="bi bi-skip-end-fill" id="nextBtn"></i>
            <i class="bi bi-volume-up" id="volumeBtn"></i>
        </div>
        <div class="volume-control">
            <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="1">
        </div>
    </div>

    <footer class="footer text-center py-3 mt-5">
        
        <p class="mb-0">Page created by AliKhan Kassymbekov IT-2307</p>
        <p class="mb-0">Date: 09.09.2024</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        class Song {
            constructor(id, title, artist, duration, audioSrc) {
                this.id = id;
                this.title = title;
                this.artist = artist;
                this.duration = duration;
                this.isLiked = false;
                this.audioSrc = audioSrc;
            }

            toggleLike() {
                this.isLiked = !this.isLiked;
            }
        }

        const hotTracks = [
            new Song(1, "Master of None", "Beach House", "3:19", "songs/Beach House Master Of None.mp3"),
            new Song(2, "Johanna", "Suki Waterhouse", "2:35", "songs/Suki Waterhouse Johanna.mp3"),
            new Song(3, "The End.", "My Chemical Romance", "1:52", "songs/My Chemical Romance The End..mp3"),
            new Song(4, "Failed at Math(s)", "Panchiko", "2:40", "songs/failed_at_maths.mp3"),
            new Song(5, "Inference (1)",    "Fog Lake", "2:14", "songs/inference.mp3"),
            new Song(6, "Rain Intermission", "Strawberry Guy", "3:56", "songs/rain_intermission.mp3"),
            new Song(7, "Myth", "Beach House", "4:18", "songs/myth.mp3"),
            new Song(8, "Every Day's A Lesson In Humility", "Suki Waterhouse, Belle and Sebastian", "3:36", "songs/every_days_a_lesson.mp3"),
            new Song(9, "Falling Apart", "Slow Pulp", "2:46", "songs/falling_apart.mp3"),
            new Song(10, "All They Wanted", "Panchiko", "2:07", "songs/all_they_wanted.mp3")
        ];

        let likedSongs = [];
        let currentPlaylist = [];
        let currentSongIndex = 0;
        let audio = new Audio();
        let isPlaying = false;
        let isShuffled = false;

        function displaySongList(songs, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            songs.forEach((song, index) => {
                const songItem = document.createElement('div');
                songItem.className = 'song-item';
                songItem.innerHTML = `
                    <span class="song-number">${index + 1}</span>
                    <div class="song-info">
                        <div class="song-title">${song.title}</div>
                        <div class="song-artist">${song.artist}</div>
                    </div>
                    <span class="song-duration">${song.duration}</span>
                    <span class="song-play" data-id="${song.id}">
                        <i class="bi bi-play-fill"></i>
                    </span>
                    <span class="song-like" data-id="${song.id}">
                        <i class="bi ${song.isLiked ? 'bi-heart-fill liked' : 'bi-heart'}"></i>
                    </span>
                `;
                container.appendChild(songItem);
            });

            container.querySelectorAll('.song-play').forEach(playBtn => {
                playBtn.addEventListener('click', (e) => {
                    const songId = parseInt(e.currentTarget.dataset.id);
                    const song = songs.find(s => s.id === songId);
                    if (song) {
                        playSong(song, songs);
                    }
                });
            });

            container.querySelectorAll('.song-like').forEach(likeBtn => {
                likeBtn.addEventListener('click', (e) => {
                    const songId = parseInt(e.currentTarget.dataset.id);
                    const song = hotTracks.find(s => s.id === songId);
                    if (song) {
                        song.toggleLike();
                        updateLikedSongs();
                        displaySongList(hotTracks, 'songList');
                        displaySongList(likedSongs, 'likedSongsList');
                    }
                });
            });
        }

        function updateLikedSongs() {
            likedSongs = hotTracks.filter(song => song.isLiked);
        }

        function playSong(song, playlist) {
            currentPlaylist = playlist;
            currentSongIndex = currentPlaylist.indexOf(song);
            audio.src = song.audioSrc;
            audio.play();
            isPlaying = true;
            updatePlayerInfo(song);
            updatePlayPauseButton();
        }

        function updatePlayerInfo(song) {
            document.getElementById('playerSongTitle').textContent = song.title;
            document.getElementById('playerSongArtist').textContent = song.artist;
            // We're not changing the image anymore
            // document.getElementById('playerCover').src = `images/meremad.png`;
        }

        function updatePlayPauseButton() {
            const playPauseBtn = document.getElementById('playPauseBtn');
            playPauseBtn.className = isPlaying ? 'bi bi-pause-circle-fill fs-1' : 'bi bi-play-circle-fill fs-1';
        }

        function togglePlayPause() {
            if (isPlaying) {
                audio.pause();
            } else {
                audio.play();
            }
            isPlaying = !isPlaying;
            updatePlayPauseButton();
        }

        function playNext() {
            currentSongIndex = (currentSongIndex + 1) % currentPlaylist.length;
            playSong(currentPlaylist[currentSongIndex], currentPlaylist);
        }

        function playPrevious() {
            currentSongIndex = (currentSongIndex - 1 + currentPlaylist.length) % currentPlaylist.length;
            playSong(currentPlaylist[currentSongIndex], currentPlaylist);
        }

        function toggleShuffle() {
            isShuffled = !isShuffled;
            document.getElementById('shuffleBtn').classList.toggle('text-primary', isShuffled);
            if (isShuffled) {
                currentPlaylist = [...currentPlaylist].sort(() => Math.random() - 0.5);
            } else {
                currentPlaylist = [...hotTracks];
            }
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        function togglePlayerVisibility(animate = true) {
            const player = document.getElementById('player');
            if (player.style.display === 'none') {
                player.style.display = 'block';
                if (animate) {
                    player.style.opacity = '0';
                    player.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        player.style.transition = 'opacity 0.3s ease-out, transform 0.3s ease-out';
                        player.style.opacity = '1';
                        player.style.transform = 'translateY(0)';
                    }, 10);
                }
            } else {
                if (animate) {
                    player.style.transition = 'opacity 0.3s ease-in, transform 0.3s ease-in';
                    player.style.opacity = '0';
                    player.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        player.style.display = 'none';
                    }, 300);
                } else {
                    player.style.display = 'none';
                }
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const hotTracksCard = document.getElementById('hotTracks');
            const songListContainer = document.getElementById('songListContainer');
            const likedSongsCard = document.getElementById('likedSongs');
            const likedSongsContainer = document.getElementById('likedSongsContainer');
            const player = document.getElementById('player');
            const recentlyPlayed = document.getElementById('recentlyPlayed');
            const playPauseBtn = document.getElementById('playPauseBtn');
            const nextBtn = document.getElementById('nextBtn');
            const prevBtn = document.getElementById('prevBtn');
            const shuffleBtn = document.getElementById('shuffleBtn');
            const seekBar = document.getElementById('seekBar');
            const currentTimeEl = document.getElementById('currentTime');
            const durationEl = document.getElementById('duration');
            const volumeBtn = document.getElementById('volumeBtn');
            const volumeSlider = document.getElementById('volumeSlider');
            const volumeControl = document.querySelector('.volume-control');

            hotTracksCard.addEventListener('click', () => {
                songListContainer.classList.toggle('d-none');
                likedSongsContainer.classList.add('d-none');
                displaySongList(hotTracks, 'songList');
                currentPlaylist = hotTracks;
            });

            likedSongsCard.addEventListener('click', () => {
                likedSongsContainer.classList.toggle('d-none');
                songListContainer.classList.add('d-none');
                displaySongList(likedSongs, 'likedSongsList');
                currentPlaylist = likedSongs;
            });

            recentlyPlayed.addEventListener('click', () => togglePlayerVisibility());

            playPauseBtn.addEventListener('click', () => {
                playPauseBtn.style.transform = 'scale(0.8)';
                setTimeout(() => {
                    playPauseBtn.style.transform = 'scale(1)';
                }, 200);
                togglePlayPause();
            });

            nextBtn.addEventListener('click', () => {
                nextBtn.style.transform = 'translateX(5px)';
                setTimeout(() => {
                    nextBtn.style.transform = 'translateX(0)';
                }, 200);
                playNext();
            });

            prevBtn.addEventListener('click', () => {
                prevBtn.style.transform = 'translateX(-5px)';
                setTimeout(() => {
                    prevBtn.style.transform = 'translateX(0)';
                }, 200);
                playPrevious();
            });

            shuffleBtn.addEventListener('click', () => {
                shuffleBtn.style.transform = 'rotate(180deg)';
                setTimeout(() => {
                    shuffleBtn.style.transform = 'rotate(0deg)';
                }, 300);
                toggleShuffle();
            });

            seekBar.addEventListener('click', (e) => {
                const seekPosition = (e.offsetX / seekBar.offsetWidth) * audio.duration;
                audio.currentTime = seekPosition;
            });

            audio.addEventListener('timeupdate', () => {
                const progress = (audio.currentTime / audio.duration) * 100;
                seekBar.querySelector('.progress-bar').style.width = `${progress}%`;
                currentTimeEl.textContent = formatTime(audio.currentTime);
            });

            audio.addEventListener('loadedmetadata', () => {
                durationEl.textContent = formatTime(audio.duration);
            });

            audio.addEventListener('ended', playNext);

            volumeBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                volumeControl.style.display = volumeControl.style.display === 'none' ? 'block' : 'none';
            });

            volumeSlider.addEventListener('input', (e) => {
                audio.volume = e.target.value;
            });

            document.addEventListener('click', (e) => {
                if (!volumeControl.contains(e.target) && e.target !== volumeBtn) {
                    volumeControl.style.display = 'none';
                }
            });

            let isDragging = false;
            let startX, startY, startLeft, startTop;

            player.addEventListener('mousedown', startDragging);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDragging);

            function startDragging(e) {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                startLeft = player.offsetLeft;
                startTop = player.offsetTop;
            }

            function drag(e) {
                if (!isDragging) return;
                e.preventDefault();
                let newLeft = startLeft + e.clientX - startX;
                let newTop = startTop + e.clientY - startY;
                
                newLeft = Math.max(0, Math.min(newLeft, window.innerWidth - player.offsetWidth));
                newTop = Math.max(0, Math.min(newTop, window.innerHeight - player.offsetHeight));
                
                player.style.left = newLeft + 'px';
                player.style.top = newTop + 'px';
                player.style.right = 'auto';
                player.style.bottom = 'auto';
            }

            function stopDragging() {
                isDragging = false;
            }

            document.addEventListener('keydown', (e) => {
                if (e.key === 'p' || e.key === 'P') {
                    togglePlayerVisibility();
                }
            });

            displaySongList(hotTracks, 'songList');
            displaySongList(likedSongs, 'likedSongsList');
        });

        // Save player state before unload
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('playerState', JSON.stringify({
                currentSongIndex: currentSongIndex,
                currentTime: audio.currentTime,
                isPlaying: isPlaying,
                volume: audio.volume,
                isShuffled: isShuffled
            }));
        });

        // Restore player state on page load
        window.addEventListener('load', () => {
            const savedState = JSON.parse(localStorage.getItem('playerState'));
            if (savedState) {
                currentSongIndex = savedState.currentSongIndex;
                audio.currentTime = savedState.currentTime;
                isPlaying = savedState.isPlaying;
                audio.volume = savedState.volume;
                isShuffled = savedState.isShuffled;

                if (currentSongIndex < hotTracks.length) {
                    updatePlayerInfo(hotTracks[currentSongIndex]);
                    audio.src = hotTracks[currentSongIndex].audioSrc;
                    if (isPlaying) {
                        audio.play();
                    }
                    updatePlayPauseButton();
                }
            }
        });
    </script>
</body>
</html>